
@{ ViewData["Title"] = "Dashboard";
    Layout = "~/Views/Shared/_Layout_Portal.cshtml";
    var role = ViewBag.Role;

    var permissions = (portal.models.RoleAdmin.Permissions)ViewBag.Permissions;

    var canRoleManagerWorkSubmitted = (permissions == null) ? false : (bool)permissions["AC_WS"];

    var acceptDocumentTypes = ViewBag.acceptDocumentTypes;
    var isMultipleDocumentUpload = ViewBag.isMultipleDocumentUpload;
    var maxDocumentUpload = ViewBag.maxDocumentUpload;
    var maxDocumentFileSize = ViewBag.maxDocumentFileSize;
    }

<style>
    .link-text:hover {
        color: #22b9ff !important;
    }

    .kt-portlet .kt-portlet__foot {
        padding: 10px 5px 10px 10px !important;
    }

    .k-grid-header .k-filterable, .k-grid-header .k-with-icon {
        padding-right: calc(1px + .5rem + 1.5em + .5rem);
    }

    .wapper {
        background-color: #ffffff;
        position: relative;
        width: 707px;
        height: 100px;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        user-select: none;
        left: 10px;
        top: 10px;
    }

    .signaturewrapper {
        background-color: #808080;
        width: 730px;
        height: 120px;
    }
</style>
<link href="~/css/Dashboard/main.css" rel="stylesheet" />
<div class="content" id="dv_Portal_Deshboard">
    <input type="hidden" id="newId" />
    <div class="kt-portlet">


        @if (role == "900")
        {
    <div class="kt-portlet__body">
        <div v-for="item in Notifications">
            <div style="border:1px solid; margin-bottom:7px;">
                <a v-on:click="GoToSummary(item.topic_id)" style="cursor: pointer;">
                    <span style="margin-left:2%; font-size:17px;"> {{item.Topic}}&nbsp;&nbsp; <span>({{item.Status}})</span> </span>
                    <br />
                    <span style="margin-left:2%; font-size:15px;"> {{item.rejected_reason}}</span>

                </a>
                <br />
            </div>
        </div>
        <br />

        <div class="title">
            <h1><span class="icon-mortarboard"></span>My Course Summary </h1>
            <div class="arrow-title"></div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <!-- Completed Summary -->
                <div class="completed">
                    <div class="subheader subleft">
                        <span style="font-size:20px;">
                            Enrolment Date :
                            {{LearnerEnrolDate}}
                        </span>
                    </div>
                    <div class="subheader subright">
                        <span style="font-size:20px;">
                            Planned End Date :
                            {{Learner_PlannedEndDate}}
                        </span>
                    </div>
                    <div class="clear"></div>
                    <div class="comopleted-total">
                        <span data-toggle="tooltip" data-placement="bottom" title="Completed{{iPercentageCompletion}}">
                            {{Learner_PercentageCompleted}} %
                        </span>
                    </div>
                    <div class="progressbar">
                        <div style="width:'{{iPercentageCompletion}}'"></div>
                    </div>
                    <p>
                        <a asp-area="Portal" asp-controller="CourseSummary" asp-action="MyCourseSummary" class="view-cta" title="See Full Course Activity">See Full Course Activity  <span class="icon-next2"></span></a>
                    </p>
                </div>
                <!-- End Completed Summary -->
            </div>
            <div class="col-sm-6">
                <!-- Topics Completed Summary -->
                <div class="left-topics-summary">
                    <div class="subheader">
                        Completed Tasks
                    </div>
                    <!-- circle with link -->
                    <a href="#" data-toggle="tooltip" data-placement="bottom" title="Completed Tasks" class="circle red-b">
                        <label>{{NbTopicsCompleted}}</label>
                    </a>
                    <!-- end -->
                </div>
                <div class="right-topics-summary">
                    <div class="subheader">

                        Tasks to be Completed
                    </div>
                    <!-- circle without link -->
                    <div data-toggle="tooltip" data-placement="bottom" title="Tasks to be Completed" class="circle red-b">
                        <label>{{NbTopicsToBeCompleted}}</label>
                    </div>
                    <!-- end -->
                </div>
                <div class="clear"></div>
                <div class="left-topics-completed">
                    <h3>Last Completed</h3>
                    <p>
                        {{TitleTopicCompleted}}
                    </p>
                    <br />
                    <h3>Total GLH: {{CompletedGLH}}</h3>
                </div>
                <div class="right-topics-next">
                    <h3>Next Task</h3>
                    <p>
                        {{TitleTopicNext}}
                    </p>
                </div>
                <div class="clear"></div>
                <!-- End Topics Completed Summary -->
            </div>
        </div>

        <div class="row">
            <div class="col-sm-8">
                <a class="twitter-timeline" href="https://twitter.com/AccessSkills">Tweets by AccessSkills</a>
                <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


            </div>
            <div class="col-sm-4">

                <div class="twitter-timeline twitter-timeline-rendered SandboxRoot var-fully-expanded env-bp-970 timeline-Widget">

                    <div class="timeline-Header">


                        <h1 style="font-size: 32px; line-height: 38px; font-weight: 300" class="timeline-Header-title u-inlineBlock" data-scribe="element:title">
                            Follow us <span class="timeline-Header-byline" data-scribe="element:byline">
                                on
                                <a class="customisable-highlight" href="https://www.facebook.com/Access-Skills-Health-Social-Care-Training-257029987724346/" title="&lrm;Facebook"><span></span></a>
                            </span>
                        </h1>

                    </div>

                    <div id="post" style="overflow-x: auto; max-width: 100%;">
                        <div id="fb-root" style="overflow-x: auto; max-width: 100%;"></div>
                        <script>
                            (function (d, s, id) {
                                var js, fjs = d.getElementsByTagName(s)[0];
                                if (d.getElementById(id)) return;
                                js = d.createElement(s); js.id = id;
                                js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.8";
                                fjs.parentNode.insertBefore(js, fjs);
                            }(document, 'script', 'facebook-jssdk'));</script>

                        <div class="fb-page" style="overflow-x: auto; max-width: 100%;"
                             data-href="https://www.facebook.com/Access-Skills-Health-Social-Care-Training-257029987724346/"
                             data-tabs="timeline"
                             data-small-header="false"
                             data-adapt-container-width="true"
                             data-hide-cover="false"
                             data-width="900"
                             data-height="4900"
                             data-show-facepile="true">
                            <blockquote cite="https://www.facebook.com/Access-Skills-Health-Social-Care-Training-257029987724346/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/Access-Skills-Health-Social-Care-Training-257029987724346/">Access Skills Health &amp; Social Care Training</a></blockquote>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>}
        @if (role == "1000")
        {
    <div class="kt-portlet__head">
        <label id="lblUserHeader" style="font-size: large;font-weight:500;margin-left:-10px;margin-top:20px;">Ready To Mark</label>
        <div class="kt-portlet__head-toolbar">


        </div>
    </div>
                    <div class="kt-portlet__body">
                        <div class="box-header with-border">
                            <ul class="nav nav-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#kt_tabs_1_1">
                                        <i class="fa fa-id-card"></i> Ready To Mark
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#kt_tabs_1_2">
                                        <i class="fa fa-address-card"></i> Summary
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#kt_tabs_1_3">
                                        <i class="fa fa-address-card"></i> Audit
                                    </a>
                                </li>

                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane active" id="kt_tabs_1_1" role="tabpanel">
                                    <div class="row">
                                        <div class="col-lg-9">

                                        </div>
                                        <div class="col-lg-3" style="margin-bottom:10px">
                                            <input type="text" autocomplete="off" class="form-control" id="searchsubmit" />
                                        </div>
                                    </div>
                                    @(Html.Kendo().Grid<crm.portal.CrmModel.UploadWork>
                        ()
                        .Name("grid_submitted")
                        .Columns(columns =>
                        {
                            columns.Bound(p => p.topic_id).Hidden();
                            columns.Bound(p => p.id).Hidden();

                            columns.Bound(p => p.created_on).Format("{0:dd/MM/yyyy}").Title("Date");
                            columns.Bound(p => p.learner_id).Title("Learner Id");
                            columns.Bound(p => p.LearnerName).Title("Learner Name");
                            columns.Bound(p => p.Topic).Title("Topic");
                            columns.Template("<div class='gridactionbuttonscontainer'><a class='kt-font-brand' style='cursor:pointer;' onclick=PerformFiles('#:id#') title='Files'><span style='text-align:center;' class='fa fa-file'></span></a>" +
                                              "&nbsp;&nbsp;<a class='kt-font-brand' style='cursor:pointer;' onclick=HistoryFileView('#:learner_id#','#:topic_id#') title='History Files'><span style='text-align:center;' class='fa fa-eye'></span></a>" +

                                "</div>").Width(100).ClientHeaderTemplate("Files");
                            columns.Bound(p => p.due_date).ClientTemplate("#= kendo.toString(kendo.parseDate(due_date), 'dd/MM/yyyy') #").Title("Due Date"); ;
                            columns.Template("<div class='kt-font-primary'><a class='kt-font-brand' style='cursor:pointer;' title='Activity Completed' onclick=PerformApprove('#:id#')><span style='text-align:center;' class='fa fa-check''></span></a>" +
                               "&nbsp;&nbsp;<a class='kt-font-warning' style='cursor:pointer;' onclick=PerformReject('#:id#') title='Resubmission Required'><span style='text-align:center;' class='fa fa-user-alt-slash'></span></a>" +
                                "&nbsp;&nbsp;<a class='kt-font-warning' style='cursor:pointer;' onclick=PerformUploadFile('#:topic_id#','#:learner_id#') title='Upload'><span style='text-align:center;' class='fa fa-file'></span></a>" +

                               "</div>").Width(100).ClientHeaderTemplate(" ");
                        })
                        .Resizable(resize => resize.Columns(true))
                        .Reorderable(x => x.Columns(true))
                        .ColumnMenu(c => c.Columns(true))
                        .Sortable()
                        .Pageable()
                        .Filterable()
                        .NoRecords()
                        .Pageable(pageable => pageable
                        .Refresh(true)
                        .PageSizes(true)
                        .ButtonCount(5))
                        .DataSource(dataSource =>
                        dataSource
                        .WebApi()
                        .Model(model =>
                        {
                            model.Id(p => p.id);
                        })
                        //.Events(events => events.Error("error_handler"))
                        .Read(read => read.Action("GetLearnerWork", "WorkUploadApi", new { type = "Submitted" }))
                        .PageSize(20)
                        )
                        )
                                </div>
                                <div class="tab-pane" id="kt_tabs_1_2" role="tabpanel">
                                    <div class="row">
                                        <div class="col-lg-3">
                                            <label>Completed : {{totalapprove}} </label>
                                            <br />
                                            <label>Rejected: {{totalrejected}}</label>

                                        </div>


                                    </div>

                                </div>

                                <div class="tab-pane" id="kt_tabs_1_3" role="tabpanel">
                                    <div class="">

                                        @(Html.Kendo().Grid<crm.portal.CrmModel.WorkAudit>
                        ()
                        .Name("grid_submitAudat")
                        .Columns(columns =>
                        {
                            columns.Bound(p => p.id).Hidden();

                            columns.Bound(p => p.created_on).Format("{0:dd/MM/yyyy}").Title("Date");
                            columns.Bound(p => p.learner_id).Title("Learner Id");
                            columns.Bound(p => p.learner_name).Title("Learner Name");
                            columns.Bound(p => p.topic).Title("Topic");


                        })
                        .Resizable(resize => resize.Columns(true))
                        .Reorderable(x => x.Columns(true))
                        .ColumnMenu(c => c.Columns(true))
                        .Sortable()
                        .Pageable()
                        .Filterable()
                        .NoRecords()
                        .Pageable(pageable => pageable
                        .Refresh(true)
                        .PageSizes(true)
                        .ButtonCount(5))
                        .DataSource(dataSource =>
                        dataSource
                        .WebApi()
                        .Model(model =>
                        {
                            model.Id(p => p.id);
                        })
                        //.Events(events => events.Error("error_handler"))
                        .Read(read => read.Action("GetAuditWork", "WorkUploadApi"))
                        .PageSize(20)
                        )
                        )

                                    </div>

                                </div>
                            </div>
                        </div>

                    </div>


                                    <div class="modal fade" id="kt_modal_files1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                                        <div class="modal-dialog modal-lg" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">Files</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="kt-form kt-form--label-right">
                                                        <div class="row">
                                                            <table class="table">
                                                                <tr>
                                                                    <th></th>
                                                                    <th>File Name</th>
                                                                    <th>File Type</th>
                                                                    <th>File Size</th>
                                                                </tr>
                                                                <tr v-for="file in files">
                                                                    <td><a class='kt-font-brand' v-on:click="downlaodFile(file.file_path)" style='cursor:pointer;' title='Files'><span style='text-align:center;' class='fa fa-download'></span></a></td>
                                                                    <td> {{file.file_name}}</td>
                                                                    <td>{{file.file_ext}}</td>
                                                                    <td>{{file.file_size}}</td>


                                                                </tr>
                                                            </table>

                                                        </div>



                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                                    <div class="modal fade" id="kt_modal_reject_reason" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                                                        <div class="modal-dialog modal-lg" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel">Resubmission Required</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="kt-form kt-form--label-right">
                                                                        <div class="form-group row">
                                                                            <label class="col-form-label col-sm-4">Reason for rejection:</label>
                                                                            <div class="col-sm-8">
                                                                                <textarea class="form-control" v-model="rejected_reason"> </textarea>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                        <button type="button" class="btn btn-primary" v-on:click="workReject()">Submit</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                                    <div class="modal fade" id="kt_modal_Create" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                                                                        <div class="modal-dialog modal-lg" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <h5 class="modal-title" id="exampleModalLabel">Upload File</h5>
                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <div class="kt-form kt-form--label-right">
                                                                                        <div class="form-group">
                                                                                            <label>File</label>
                                                                                            <input name="files" id="files" type="file" aria-label="files" />
                                                                                            <span id="span_fileUpload" class="form-text text-muted"></span>
                                                                                        </div>

                                                                                    </div>
                                                                                    <div class="modal-footer">
                                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                                        <button type="button" class="btn btn-primary" v-on:click="Submit">Submit</button>

                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                                    <div class="modal fade" id="kt_modal_approve" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                                                                                        <div class="modal-dialog modal-lg" role="document">
                                                                                            <div class="modal-content">
                                                                                                <div class="modal-header">
                                                                                                    <h5 class="modal-title" id="exampleModalLabel">Activity Completed</h5>
                                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                                                                                                </div>
                                                                                                <div class="modal-body">
                                                                                                    <ul class="nav nav-tabs" role="tablist">
                                                                                                        <li class="nav-item">
                                                                                                            <a class="nav-link active" data-toggle="tab" href="#kt_tabs_A_1">
                                                                                                                <i class="fa fa-id-card"></i> Feedback
                                                                                                            </a>
                                                                                                        </li>
                                                                                                        <li class="nav-item">
                                                                                                            <a class="nav-link" data-toggle="tab" href="#kt_tabs_A_2">
                                                                                                                <i class="fa fa-address-card"></i> Note
                                                                                                            </a>
                                                                                                        </li>
                                                                                                        <li class="nav-item">
                                                                                                            <a class="nav-link" data-toggle="tab" href="#kt_tabs_A_3">
                                                                                                                <i class="fa fa-address-card"></i> Signature
                                                                                                            </a>
                                                                                                        </li>

                                                                                                    </ul>

                                                                                                    <div class="kt-form kt-form--label-right">
                                                                                                        <div class="tab-content">
                                                                                                            <div class="tab-pane active" id="kt_tabs_A_1" role="tabpanel">
                                                                                                                <div class="">
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <label>Assessment criteria and content of activity </label>
                                                                                                                        <div>
                                                                                                                            <textarea v-model="Assesser.traningAssessment.tap_content_activty" class="form-control"></textarea>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <label>Core Skills </label>
                                                                                                                        <div>
                                                                                                                            <textarea v-model="Assesser.traningAssessment.tap_core_skil" class="form-control"></textarea>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <label>Referencing and bibliography </label>
                                                                                                                        <div>
                                                                                                                            <textarea v-model="Assesser.traningAssessment.tap_referencing" class="form-control"></textarea>
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <label>Further development</label>
                                                                                                                        <div>
                                                                                                                            <textarea v-model="Assesser.traningAssessment.tap_development" class="form-control"></textarea>
                                                                                                                        </div>
                                                                                                                    </div>


                                                                                                                </div>
                                                                                                            </div>
                                                                                                            <div class="tab-pane " id="kt_tabs_A_2" role="tabpanel">
                                                                                                                <div class="row">
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <label>Assessment criteria identified on the activity brief has been met? </label>
                                                                                                                        <div>
                                                                                                                            <input type="radio" name="assementcheck" id="assessmentcheck" checked value="yes" @@change="assessmentchange($event)" /> Yes
                                                                                                                            <input type="radio" name="assementcheck" id="assessmentcheck" value="no" @@change="assessmentchange($event)" /> No
                                                                                                                        </div>
                                                                                                                    </div>
                                                                                                                    <div class="col-lg-12">
                                                                                                                        <div id="resubmissiondata">
                                                                                                                            <label>If No, resubmission within:</label>
                                                                                                                            <div>
                                                                                                                                <input type="radio" name="resubmission" id="resubmission" value="7" /> 7 Days
                                                                                                                                <input type="radio" name="resubmission" id="resubmission" value="14" /> 14 Days
                                                                                                                            </div>


                                                                                                                        </div>

                                                                                                                    </div>
                                                                                                                    <div class="col-sm-12">
                                                                                                                        <label class="col-form-label ">Notes</label>
                                                                                                                        <textarea class="form-control" v-model="notes"> </textarea>
                                                                                                                    </div>
                                                                                                                </div>

                                                                                                            </div>
                                                                                                            <div class="tab-pane " id="kt_tabs_A_3" role="tabpanel">
                                                                                                                <div class="form-group">
                                                                                                                    <div class="col-md-12">

                                                                                                                        <div class="col-lg-12">
                                                                                                                            <div class="row">
                                                                                                                                <div class="col-lg-8">
                                                                                                                                    <input style="margin-bottom: 10px; margin-left: -8px;" type="text" @@keyup="txtPrintName($event)" id="printName" :value="printName" class="form-control input-sm" placeholder="type your full name...">

                                                                                                                                </div>
                                                                                                                                <div class="col-lg-4">
                                                                                                                                    <span style="margin-bottom:10px;float:right;" id="btnClearPrintName" class="btn btn-primary">Clear Print Name</span>

                                                                                                                                </div>
                                                                                                                            </div>

                                                                                                                        </div>
                                                                                                                        <div>
                                                                                                                            <div id="panel_signature">
                                                                                                                                <!-- Please sign in the box: -->

                                                                                                                                <div style="margin-bottom: -11px;">
                                                                                                                                    <div class="signaturewrapper">
                                                                                                                                        <div class="wapper">
                                                                                                                                            <canvas id="signaturepad" class="signature-pad" width="600" height="100"></canvas>
                                                                                                                                        </div>
                                                                                                                                    </div>
                                                                                                                                    <div>
                                                                                                                                        <br />
                                                                                                                                        <input type="hidden" id="sketch_data" name="sketch_data" />
                                                                                                                                        <input type="hidden" id="hid_printname" name="hid_printname" />
                                                                                                                                        <input type="hidden" id="hid_dt" name="hid_dt" />
                                                                                                                                    </div>
                                                                                                                                </div>

                                                                                                                            </div>
                                                                                                                        </div>

                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>




                                                                                                    </div>
                                                                                                    <div class="modal-footer">
                                                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                                                        <button type="button" class="btn btn-primary" v-on:click="approve">Submit</button>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>

                                                                                                    <div class="modal fade" id="kt_modal_history" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
                                                                                                        <div class="modal-dialog modal-lg" role="document">
                                                                                                            <div class="modal-content">
                                                                                                                <div class="modal-header">
                                                                                                                    <h5 class="modal-title" id="exampleModalLabel">History Files</h5>
                                                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                                                                                                                </div>
                                                                                                                <div class="modal-body">
                                                                                                                    <div class="kt-form kt-form--label-right">
                                                                                                                        <div class="row">
                                                                                                                            <table class="table">
                                                                                                                                <tr>
                                                                                                                                    <th></th>
                                                                                                                                    <th>Course</th>
                                                                                                                                    <th>Level</th>
                                                                                                                                </tr>
                                                                                                                                <tr v-for="file in fileHistory">
                                                                                                                                    <td>
                                                                                                                                        <a class='kt-font-brand' v-on:click="DownloadViewHistory(file.tap_filedata,file.tap_learner_id)" style='cursor:pointer;' title='Download'><span style='text-align:center;' class='fa fa-eye'></span></a>
                                                                                                                                        @*<a class='kt-font-danger' v-on:click="deleteFile(file.id)" style='cursor:pointer;' title='Delete'><span style='text-align:center;' class=' fa fa-trash-alt'></span></a>*@
                                                                                                                                    </td>
                                                                                                                                    <td> {{file.tap_title}}</td>
                                                                                                                                    <td>{{file.tap_level}}</td>


                                                                                                                                </tr>
                                                                                                                            </table>

                                                                                                                        </div>



                                                                                                                    </div>
                                                                                                                    <div class="modal-footer">
                                                                                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>            }
    </div>
</div>
<style type="text/css">
    .signature_wrapper {
        background-color: #808080;
        width: 520px;
        height: 120px;
    }

    .wrapper {
        background-color: #ffffff;
        position: relative;
        width: 500px;
        height: 100px;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
        user-select: none;
        left: 10px;
        top: 10px;
    }

    img {
        position: absolute;
        left: 0;
        top: 0;
    }

    .signature-pad {
        position: absolute;
        left: 0;
        top: 0;
        width: 400px;
        height: 100px;
    }
</style>
<script>

    $(document).ready(function () {
        $("#btnClearPrintName").click(function () {
            //var btnClearPrint = document.getElementById('txtPrintName');
            $("#printName").val("");

            var canvas = document.getElementById('signaturepad'),
                context = canvas.getContext('2d');
            context.clearRect(0, 0, canvas.width, canvas.height);

        });

        

    })
</script>
<script>
    function PerformApprove(id) {
        app.notes = "";
        debugger;
        app.id = id;
        $("#newId").val(id);
        $("#kt_modal_approve").modal("show");
    }
    function PerformReject(id) {
        app.id = id;
        app.rejected_reason = "";
        $("#kt_modal_reject_reason").modal("show");
    }
    function DownlaodFile(id) {

    }
   
    function PerformUploadFile(topic_id, learnerId) {
        app.upload(topic_id, learnerId);
    }
    function PerformFiles(id) {
        app.loadFiles(id);
    }
    function formatDateEN(date) {
        const options = { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' }
        return new Date(date).toLocaleDateString('en-GB')
    }
    $("#searchsubmit").keyup(function () {
        $("#grid_submitted").data("kendoGrid").refresh();
        var type = "Submitted";
        var id = $(this).val();
        if (id != "") {
            $.ajax({
                url: "/api/WorkUploadApi/SearchWork",
                data: { type: type, name: id },
                type: "GET",
                contentType: "application/json",
                dataType: "json",
                async: false
            }).done(function (response) {
                $("#grid_submitted").data("kendoGrid").dataSource.data([]);


                let grid = $("#grid_submitted").data("kendoGrid");

                for (var i = 0; i < response.Data.length; i++) {

                    grid.dataSource.add({
                        id: response.Data[i].id, created_on: formatDateEN(response.Data[i].created_on),
                        learner_id: response.Data[i].learner_id
                        , LearnerName: response.Data[i].LearnerName,
                        Topic: response.Data[i].Topic
                        , due_date: response.Data[i].due_date, Status: response.Data[i].Status


                    });

                }


            });
        }
        else {
            $("#grid_submitted").data("kendoGrid").dataSource.read();
        }

    });


          var _acceptDocumentTypes;
        var _allowedExtensions = [];
        var _isMultipleDocumentUpload;
        var _maxDocumentUpload;
        var _maxDocumentFileSize;
        var _companyId;
    var _roleName;

    var _canRoleManagerWorkSubmitted;

    $(document).ready(function () {
        $("#resubmissiondata").hide();
        
          //  app.mounted();

           _acceptDocumentTypes = '@acceptDocumentTypes';
           _isMultipleDocumentUpload = true;
            _maxDocumentUpload = @maxDocumentUpload;
            _maxDocumentFileSize = @maxDocumentFileSize;

           if (_acceptDocumentTypes !== null)
           {
               if (_acceptDocumentTypes.includes(',')) {
                   var item = _acceptDocumentTypes.split(',');
                   for (var count = 0; count < item.length; count++) {
                       if (item[count] !== "") {
                           _allowedExtensions.push('' + item[count] + '');
                       }
                   }
               }
               else
               {
                   _allowedExtensions.push('' + _acceptDocumentTypes + '');
               }
           }

           uploadFile();

           $("#span_fileUpload").text("Max file size is " + _maxDocumentFileSize + " MB and allowed file types: " + _allowedExtensions.toString());

           $(".attachDocuments").attr("style", "display:none")






       });
    function uploadFile() {
        var _size = (_maxDocumentFileSize * 1048576);

        $("#files").kendoUpload({
            async: {
                chunkSize: 11000,// bytes
                autoUpload: true
            },
            validation: {
                allowedExtensions: _allowedExtensions,
                maxFileSize: _size
            },
            select: onSelect,
            multiple: _isMultipleDocumentUpload
        });


    }

    var _isValidationError = false;
    function onSelect(e) {
        if (e.files.length > _maxDocumentUpload) {
            toastr.error("You can select maximum " + _maxDocumentUpload + " files.", 'Error!');
            e.preventDefault();
        }

        var files = e.files;
        for (var i = 0; i < files.length; i += 1) {
            var file = files[i];
            if (file.validationErrors && file.validationErrors.length > 0) {
                toastr.error('Invaild file format.', 'Error!');
                e.preventDefault();
            }
        }
    }
</script>

@section Scripts{
    <script src="~/lib/vue/vue.js"></script>
    <script src="~/lib/vue/vuelidate.min.js"></script>
    <script src="~/lib/vue/validators.min.js"></script>
    <script src="~/js/Portal/Index.js"></script>
    @*<script src="~/js/Portal/Assessor/LearnerWork.js"></script>*@

}